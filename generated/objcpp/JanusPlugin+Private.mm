// AUTOGENERATED FILE - DO NOT MODIFY!
// This file generated by Djinni from janus-client.djinni

#import "JanusPlugin+Private.h"
#import "JanusPlugin.h"
#import "DJICppWrapperCache+Private.h"
#import "DJIError.h"
#import "DJIMarshal+Private.h"
#import "DJIObjcWrapperCache+Private.h"
#import "JanusBundle+Private.h"
#import "JanusJanusEvent+Private.h"
#include <exception>
#include <stdexcept>
#include <utility>

static_assert(__has_feature(objc_arc), "Djinni requires ARC to be enabled for this file");

@interface JanusPluginCppProxy : NSObject<JanusPlugin>

- (id)initWithCpp:(const std::shared_ptr<::Janus::Plugin>&)cppRef;

@end

@implementation JanusPluginCppProxy {
    ::djinni::CppProxyCache::Handle<std::shared_ptr<::Janus::Plugin>> _cppRefHandle;
}

- (id)initWithCpp:(const std::shared_ptr<::Janus::Plugin>&)cppRef
{
    if (self = [super init]) {
        _cppRefHandle.assign(cppRef);
    }
    return self;
}

- (void)onEvent:(nullable JanusJanusEvent *)event
        context:(nullable JanusBundle *)context {
    try {
        _cppRefHandle.get()->onEvent(::djinni_generated::JanusEvent::toCpp(event),
                                     ::djinni_generated::Bundle::toCpp(context));
    } DJINNI_TRANSLATE_EXCEPTIONS()
}

- (void)onHangup:(nonnull NSString *)reason {
    try {
        _cppRefHandle.get()->onHangup(::djinni::String::toCpp(reason));
    } DJINNI_TRANSLATE_EXCEPTIONS()
}

- (void)onClose {
    try {
        _cppRefHandle.get()->onClose();
    } DJINNI_TRANSLATE_EXCEPTIONS()
}

- (void)command:(nonnull NSString *)command
        payload:(nullable JanusBundle *)payload {
    try {
        _cppRefHandle.get()->command(::djinni::String::toCpp(command),
                                     ::djinni_generated::Bundle::toCpp(payload));
    } DJINNI_TRANSLATE_EXCEPTIONS()
}

- (void)onOffer:(nonnull NSString *)sdp
        context:(nullable JanusBundle *)context {
    try {
        _cppRefHandle.get()->onOffer(::djinni::String::toCpp(sdp),
                                     ::djinni_generated::Bundle::toCpp(context));
    } DJINNI_TRANSLATE_EXCEPTIONS()
}

- (void)onAnswer:(nonnull NSString *)sdp
         context:(nullable JanusBundle *)context {
    try {
        _cppRefHandle.get()->onAnswer(::djinni::String::toCpp(sdp),
                                      ::djinni_generated::Bundle::toCpp(context));
    } DJINNI_TRANSLATE_EXCEPTIONS()
}

namespace djinni_generated {

class Plugin::ObjcProxy final
: public ::Janus::Plugin
, private ::djinni::ObjcProxyBase<ObjcType>
{
    friend class ::djinni_generated::Plugin;
public:
    using ObjcProxyBase::ObjcProxyBase;
    void onEvent(const std::shared_ptr<::Janus::JanusEvent> & c_event, const std::shared_ptr<::Janus::Bundle> & c_context) override
    {
        @autoreleasepool {
            [djinni_private_get_proxied_objc_object() onEvent:(::djinni_generated::JanusEvent::fromCpp(c_event))
                                                      context:(::djinni_generated::Bundle::fromCpp(c_context))];
        }
    }
    void onHangup(const std::string & c_reason) override
    {
        @autoreleasepool {
            [djinni_private_get_proxied_objc_object() onHangup:(::djinni::String::fromCpp(c_reason))];
        }
    }
    void onClose() override
    {
        @autoreleasepool {
            [djinni_private_get_proxied_objc_object() onClose];
        }
    }
    void command(const std::string & c_command, const std::shared_ptr<::Janus::Bundle> & c_payload) override
    {
        @autoreleasepool {
            [djinni_private_get_proxied_objc_object() command:(::djinni::String::fromCpp(c_command))
                                                      payload:(::djinni_generated::Bundle::fromCpp(c_payload))];
        }
    }
    void onOffer(const std::string & c_sdp, const std::shared_ptr<::Janus::Bundle> & c_context) override
    {
        @autoreleasepool {
            [djinni_private_get_proxied_objc_object() onOffer:(::djinni::String::fromCpp(c_sdp))
                                                      context:(::djinni_generated::Bundle::fromCpp(c_context))];
        }
    }
    void onAnswer(const std::string & c_sdp, const std::shared_ptr<::Janus::Bundle> & c_context) override
    {
        @autoreleasepool {
            [djinni_private_get_proxied_objc_object() onAnswer:(::djinni::String::fromCpp(c_sdp))
                                                       context:(::djinni_generated::Bundle::fromCpp(c_context))];
        }
    }
};

}  // namespace djinni_generated

namespace djinni_generated {

auto Plugin::toCpp(ObjcType objc) -> CppType
{
    if (!objc) {
        return nullptr;
    }
    if ([(id)objc isKindOfClass:[JanusPluginCppProxy class]]) {
        return ((JanusPluginCppProxy*)objc)->_cppRefHandle.get();
    }
    return ::djinni::get_objc_proxy<ObjcProxy>(objc);
}

auto Plugin::fromCppOpt(const CppOptType& cpp) -> ObjcType
{
    if (!cpp) {
        return nil;
    }
    if (auto cppPtr = dynamic_cast<ObjcProxy*>(cpp.get())) {
        return cppPtr->djinni_private_get_proxied_objc_object();
    }
    return ::djinni::get_cpp_proxy<JanusPluginCppProxy>(cpp);
}

}  // namespace djinni_generated

@end
